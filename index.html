<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Checklist - Resposta a Incidentes (NIST SP 800-61)</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-preparacao: #666666;
      --color-deteccao: #666666;
      --color-contencao: #666666;
      --color-erradicacao: #666666;
      --color-recuperacao: #666666;
      --color-pos: #666666;
    }
    body {
      font-family: 'Roboto', sans-serif;
      font-size: 12px;
      margin: 0;
      padding: 20px;
      background: #f4f4f4;
      color: #333;
      line-height: 1.5;
    }
    .page {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 30px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
    }
    h1 {
      text-align: center;
      background-color: #666666;
      color: #ffffff;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      font-size: 20px;
    }
    h2 {
      color: #fff;
      border-radius: 4px;
      margin-top: 25px;
      margin-bottom: 0;
      font-size: 14px;
      padding: 8px 12px;
    }
    /* Cores das Fases */
    .h-preparacao { background: var(--color-preparacao); }
    .h-deteccao { background: var(--color-deteccao); }
    .h-contencao { background: var(--color-contencao); }
    .h-erradicacao { background: var(--color-erradicacao); }
    .h-recuperacao { background: var(--color-recuperacao); }
    .h-pos { background: var(--color-pos); }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      vertical-align: middle;
    }
    th {
      background: #f9f9f9;
      text-align: left;
      font-weight: 700;
      width: 150px;
    }
    label {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      width: 100%;
    }
    input[type=checkbox] {
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
    .condicional {
      background: #fff3e0;
      font-weight: 700;
      font-style: italic;
      color: #e65100;
      font-size: 11px;
    }
    .actions {
      margin-top: 30px;
      display: flex;
      gap: 15px;
      justify-content: center;
    }
    button {
      padding: 10px 20px;
      font-weight: bold;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      transition: 0.2s;
    }
    .save-btn { background: #2e7d32; color: #fff; }
    .save-btn:hover { background: #1b5e20; }
    .clear-btn { background: #757575; color: #fff; }
    .clear-btn:hover { background: #424242; }
  </style>
</head>
<body>
  <div class="page">
    <h1>Checklist de Resposta: Comprometimento de Contas</h1>
    <p>Este checklist tem como objetivo guiar a resposta estruturada a incidentes de comprometimento de contas, garantindo que todas as ações necessárias sejam executadas de forma completa e documentada.</p>

    <h2 class="h-preparacao">1. PREPARAÇÃO</h2>
    <table>
      <tr><th>Políticas</th><td><label><input type="checkbox" id="c1-1"> Validar Baseline de comportamento e acessos da conta</label></td></tr>
      <tr><th>Controles</th><td><label><input type="checkbox" id="c1-2"> Confirmar se MFA está ativo e métodos de recuperação configurados</label></td></tr>
      <tr><th>Mapeamento de contas críticas</th><td><label><input type="checkbox" id="c1-1"> Focar no impacto que a perda dessas credenciais causaria à operação</label></td></tr>
      <tr><th>Gestão de Privilégios</th><td><label><input type="checkbox" id="c1-2"> Impedir que um comprometimento de conta comum se transforme em um desastre total (movimentação lateral).</label></td></tr>
    </table>

    <h2 class="h-deteccao">2. DETECÇÃO E ANÁLISE</h2>
    <table>
      <tr><th>Triagem</th><td><label><input type="checkbox" id="c2-1"> Analisar Geolocalização, IP e User-Agent do login suspeito</label></td></tr>
      <tr><th>Impacto</th><td><label><input type="checkbox" id="c2-2"> Identificar nível de privilégio e criticidade dos dados acessados</label></td></tr>
      <tr><th>Coleta</th><td><label><input type="checkbox" id="c2-3"> Preservar Logs de Auditoria (Sign-in logs, UAL, Audit logs)</label></td></tr>
    </table>

    <h2 class="h-contencao">3. CONTENÇÃO</h2>
    <table>
      <tr><th>Sessão</th><td><label><input type="checkbox" id="c3-1"> Revogar todos os Refresh Tokens de OAuth (Logout forçado)</label></td></tr>
      <tr><th>Acesso</th><td><label><input type="checkbox" id="c3-2"> Bloquear/Desabilitar conta no IDP (Entra ID, AD, Okta)</label></td></tr>
      <tr><td colspan="2" class="condicional">Se houver movimentação lateral detectada:</td></tr>
      <tr><th>Isolamento</th><td><label><input type="checkbox" id="c3-3"> Isolar máquinas afetadas via EDR/Firewall</label></td></tr>
    </table>

    <h2 class="h-erradicacao">4. ERRADICAÇÃO</h2>
    <table>
      <tr><th>Revogação de Sessões</th><td><label><input type="checkbox" id="c4-3">  Utilize o recurso de Revogar Tokens de Atualização para desconectar o usuário de todos os dispositivos imediatamente.
      </label></td></tr>
      <tr><th>Contas de "Shadow Admin"</th><td><label><input type="checkbox" id="c4-1"> Procure por novas contas criadas com nomes que pareçam legítimos para servirem de backdoor.</label></td></tr>
      <tr><th>Persistência</th><td><label><input type="checkbox" id="c4-1"> Auditar e remover Regras de Encaminhamento de E-mail</label></td></tr>
      <tr><th>Apps</th><td><label><input type="checkbox" id="c4-2"> Remover permissões de Aplicativos de Terceiros (Enterprise Apps)</label></td></tr>
      <tr><th>Varredura</th><td><label><input type="checkbox" id="c4-3"> Executar Full Scan antimalware em dispositivos vinculados à conta</label></td></tr>
    </table>

    <h2 class="h-recuperacao">5. RECUPERAÇÃO</h2>
    <table>
      <tr><th>Restauração de Acessos</th><td><label><input type="checkbox" id="c5-1"> O acesso do usuário só deve ser devolvido após uma verificação forte.</label></td></tr>
      <tr><th>Credenciais</th><td><label><input type="checkbox" id="c5-1"> Realizar Reset de Senha (complexidade conforme política)</label></td></tr>
      <tr><th>MFA</th><td><label><input type="checkbox" id="c5-2"> Revalidar/Recadastrar fatores de autenticação (MFA)</label></td></tr>
      <tr><th>Monitoramento</th><td><label><input type="checkbox" id="c5-3"> Colocar conta em "Watchlist" de alta prioridade no SIEM por 7 dias</label></td></tr>
      <tr><th>Retorno ao Baseline</th><td><label><input type="checkbox" id="c5-3"> Se não houver anomalias, a conta volta ao monitoramento, e o incidente é formalmente fechado nas Atividades Pós-Incidente do NIST.</label></td></tr>
    </table>

    <h2 class="h-pos">6. ATIVIDADES PÓS-INCIDENTE</h2>
    <table>
      <tr><th>Documentação</th><td><label><input type="checkbox" id="c6-1"> Elaborar Relatório de Lições Aprendidas (Causa Raiz)</label></td></tr>
      <tr><th>Métricas</th><td><label><input type="checkbox" id="c6-2"> Registrar MTTR (Tempo Médio de Resposta) e Impacto</label></td></tr>
      <tr><th>Melhoria</th><td><label><input type="checkbox" id="c6-3"> Atualizar Playbook e base de conhecimento </label></td></tr>
      <tr><th>Conclusão</th><td><label><input type="checkbox" id="c6-4"> Formalizar o encerramento do ticket/incidente</label></td></tr>
    </table>

    <div class="actions">
      <button class="save-btn" id="save-btn">Salvar Progresso</button>
      <button class="clear-btn" id="clear-btn">Limpar Checklist</button>
    </div>
  </div>

  <script>
    const checkboxes = document.querySelectorAll("input[type=checkbox]");
    
    // Restaurar estado
    window.onload = () => {
      checkboxes.forEach(cb => {
        cb.checked = localStorage.getItem(cb.id) === "true";
      });
    };

    // Salvar ao clicar
    document.getElementById("save-btn").onclick = () => {
      checkboxes.forEach(cb => localStorage.setItem(cb.id, cb.checked));
      alert("Checklist salvo com sucesso!");
    };

    // Limpar
    document.getElementById("clear-btn").onclick = () => {
      if(confirm("Deseja limpar todo o progresso?")) {
        checkboxes.forEach(cb => {
          cb.checked = false;
          localStorage.removeItem(cb.id);
        });
      }
    };
  </script>
</body>
</html>